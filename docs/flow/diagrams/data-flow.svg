<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1303px" preserveAspectRatio="none" style="width:998px;height:1303px;background:#FFFFFF;" version="1.1" viewBox="0 0 998 1303" width="998px" zoomAndPan="magnify"><defs/><g><g id="elem_N1"><path d="M159,6 L159,122.2361 L498,122.2361 L498,16 L488,6 L159,6 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M488,6 L488,16 L498,16 L488,6 " fill="#FAFAFA" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299" x="165" y="24.897">Data after going though Data Gateway is wrapped</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="168" y="42.603">inside an Environment Message, this message is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318" x="165" y="60.309">'open' in each container so that data can be accessed.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="168" y="78.0151">Then, once the work is done the message is 'sealed',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301" x="168" y="95.7211">routing keys are changed and the message is sent.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299" x="165" y="113.4271">For brevity this process is not detailed everywhere</text></g><g id="DataRelayer"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="213" x="7" y="192.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="220" y1="221.5679" y2="221.5679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="71" y="212.4659">Data Relayer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="12" y="241.5339">Any data can be received</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="193" x="12" y="260.6018">as the body of an HTTP POST</text></g><g id="DataGateway"><rect fill="#F1F1F1" height="96.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="203" x="255" y="183"/><line style="stroke:#181818;stroke-width:0.5;" x1="255" x2="458" y1="212.0679" y2="212.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="310.5" y="202.9659">Data Gateway</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="260" y="232.0339">Data is wraped in a</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183" x="260" y="251.1018">Environment Message with</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="260" y="270.1697">specific routing keys</text></g><g id="elem_decoded_or_encoded"><polygon fill="#F1F1F1" points="505.5,219,517.5,231,505.5,243,493.5,231,505.5,219" style="stroke:#181818;stroke-width:0.5;"/></g><g id="Processor"><rect fill="#F1F1F1" height="96.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="237" x="233" y="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="233" x2="470" y1="387.0679" y2="387.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="282" y="377.9659">Data Processor Slave</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205" x="238" y="407.0339">Data is transformed according</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="201" x="238" y="426.1018">to the defined mapper for the</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="238" y="445.1697">type of device that sent the data</text></g><g id="Decoder"><rect fill="#F1F1F1" height="96.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="237" x="505" y="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="505" x2="742" y1="387.0679" y2="387.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="558.5" y="377.9659">Data Decoder Slave</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205" x="510" y="407.0339">Data is transformed according</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="510" y="426.1018">to the defined script for the</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="510" y="445.1697">type of device that sent the data</text></g><g id="Identity"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="222" x="375.5" y="515"/><line style="stroke:#181818;stroke-width:0.5;" x1="375.5" x2="597.5" y1="544.0679" y2="544.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="425.5" y="534.9659">Device Ownership</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="202" x="380.5" y="564.0339">Domain ownership details are</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="380.5" y="583.1018">added to the data</text></g><g id="Validator"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="373" y="889"/><line style="stroke:#181818;stroke-width:0.5;" x1="373" x2="600" y1="918.0679" y2="918.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="439" y="908.9659">Data Validator</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="207" x="378" y="938.0339">Data is examined to determine</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="378" y="957.1018">if it is valid or not</text></g><g id="Device"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="197" x="388" y="751"/><line style="stroke:#181818;stroke-width:0.5;" x1="388" x2="585" y1="780.0679" y2="780.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="398" y="770.9659">Device Management Slave</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176" x="393" y="800.0339">Device information details</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="393" y="819.1018">are added to the data</text></g><g id="elem_data_type"><polygon fill="#F1F1F1" points="486.5,1063,498.5,1075,486.5,1087,474.5,1075,486.5,1063" style="stroke:#181818;stroke-width:0.5;"/></g><g id="Fleet"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="133" y="1220"/><line style="stroke:#181818;stroke-width:0.5;" x1="133" x2="294" y1="1249.0679" y2="1249.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="150.5" y="1239.9659">Fleet Management</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="138" y="1269.0339">Data is stored</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="138" y="1288.1018">and sent to Frontend</text></g><g id="Irrigation"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="540" y="1220"/><line style="stroke:#181818;stroke-width:0.5;" x1="540" x2="701" y1="1249.0679" y2="1249.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="566.5" y="1239.9659">Smart Irrigation</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="545" y="1269.0339">Data is stored</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="545" y="1288.1018">and sent to Frontend</text></g><g id="Alert"><rect fill="#F1F1F1" height="96.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="605" y="1027"/><line style="stroke:#181818;stroke-width:0.5;" x1="605" x2="762" y1="1056.0679" y2="1056.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="629" y="1046.9659">Alert Dispatcher</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="610" y="1076.0339">Data is analised and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="610" y="1095.1018">alerts are produced</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="610" y="1114.1697">based on rules</text></g><ellipse cx="113.5" cy="64" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><!--MD5=[a0178e5e24e024d219a1e7cb3b47531f]
link *start to DataRelayer--><g id="link_*start_DataRelayer"><path d="M113.5,74.34 C113.5,95.68 113.5,149.09 113.5,187.39 " fill="none" id="*start-to-DataRelayer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="113.5,192.45,117.5,183.45,113.5,187.45,109.5,183.45,113.5,192.45" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e1630b80edfd2c93eafeb4e847606ce3]
link DataRelayer to DataGateway--><g id="link_DataRelayer_DataGateway"><path d="M220.29,231 C230.1,231 239.92,231 249.74,231 " fill="none" id="DataRelayer-to-DataGateway" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="254.87,231,245.87,227,249.87,231,245.87,235,254.87,231" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[68b8774cebcc3d6e6b7465b21a78ccfb]
link DataGateway to decoded_or_encoded--><g id="link_DataGateway_decoded_or_encoded"><path d="M458.06,231 C468.06,231 478.05,231 488.04,231 " fill="none" id="DataGateway-to-decoded_or_encoded" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="493.27,231,484.27,227,488.27,231,484.27,235,493.27,231" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[22e08d9b35ceb90cb3450d5235db0222]
link decoded_or_encoded to Processor--><g id="link_decoded_or_encoded_Processor"><path d="M501.47,239.32 C496.08,248.85 486,265.83 475.5,279 C454.53,305.32 428.78,332.2 406.19,354.34 " fill="none" id="decoded_or_encoded-to-Processor" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="402.59,357.85,411.8246,354.4264,406.1682,354.3577,406.2369,348.7012,402.59,357.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="448.5" y="323.897">decoded data</text></g><!--MD5=[a85dd681901aa81ed2fc6730caa183cc]
link decoded_or_encoded to Decoder--><g id="link_decoded_or_encoded_Decoder"><path d="M509.98,238.57 C522.72,257.25 560.06,311.98 588.46,353.63 " fill="none" id="decoded_or_encoded-to-Decoder" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="591.36,357.87,589.5959,348.1804,588.5438,353.7386,582.9856,352.6864,591.36,357.87" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="568.5" y="323.897">encoded data</text></g><!--MD5=[b94b5d0d3dda6a0d9fe052f75f70a547]
link Decoder to Identity--><g id="link_Decoder_Identity"><path d="M579.02,454.24 C561.88,472.45 542.44,493.09 525.82,510.74 " fill="none" id="Decoder-to-Identity" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="522.1,514.7,531.1811,510.8877,525.5268,511.059,525.3555,505.4047,522.1,514.7" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4feb289d09c7a44b5fede9831ec6c4cb]
link Processor to Identity--><g id="link_Processor_Identity"><path d="M395.33,454.24 C412.22,472.45 431.38,493.09 447.76,510.74 " fill="none" id="Processor-to-Identity" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="451.42,514.7,448.2396,505.3788,448.0227,511.0315,442.37,510.8145,451.42,514.7" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[84465410f7624ffe1fb78c12e183c7f8]
link Identity to Device--><g id="link_Identity_Device"><path d="M486.5,592.1 C486.5,634.06 486.5,701.82 486.5,745.76 " fill="none" id="Identity-to-Device" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="486.5,751,490.5,742,486.5,746,482.5,742,486.5,751" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c9372aa24827f0618d69fcbe94519af3]
link Device to Identity--><g id="link_Device_Identity"><path d="M501.09,750.82 C504.16,741.24 506.93,730.86 508.5,721 C515.4,677.54 515.4,665.46 508.5,622 C507.2,613.83 505.08,605.31 502.64,597.18 " fill="none" id="Device-to-Identity" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="501.09,592.18,499.9198,601.9591,502.5634,596.958,507.5646,599.6016,501.09,592.18" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="531.5" y="667.897">each sub device</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="514.5" y="685.603">data is sub processed</text></g><!--MD5=[02ec99bbf148d8228ce541aa1fcd1c2d]
link Device to Validator--><g id="link_Device_Validator"><path d="M486.5,828.02 C486.5,845.12 486.5,865.47 486.5,883.21 " fill="none" id="Device-to-Validator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="486.5,888.63,490.5,879.63,486.5,883.63,482.5,879.63,486.5,888.63" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1766502b7bab0552bf8c0bf94460be7a]
link Validator to data_type--><g id="link_Validator_data_type"><path d="M486.5,966.35 C486.5,996 486.5,1035.79 486.5,1057.74 " fill="none" id="Validator-to-data_type" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="486.5,1062.92,490.5,1053.92,486.5,1057.92,482.5,1053.92,486.5,1062.92" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[70f9be3945a17cf534be9b087fbdd4c1]
link data_type to Fleet--><g id="link_data_type_Fleet"><path d="M475.1,1075.69 C435.26,1075.28 301.01,1079.61 234.5,1153 C219.49,1169.56 213.97,1193.75 212.33,1214.69 " fill="none" id="data_type-to-Fleet" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="211.99,1219.93,216.5715,1211.2117,212.3179,1214.9408,208.5888,1210.6871,211.99,1219.93" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="235.5" y="1167.897">data is valid, has</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="252" y="1185.603">gps details</text></g><!--MD5=[29921640b317d18516d080204e8f3cac]
link data_type to Irrigation--><g id="link_data_type_Irrigation"><path d="M477.65,1078.63 C441.29,1089.89 307.2,1135.88 349.5,1190 C372.28,1219.15 464.18,1237.53 534.71,1247.62 " fill="none" id="data_type-to-Irrigation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="539.75,1248.34,531.3977,1243.1209,534.7991,1247.6409,530.2791,1251.0423,539.75,1248.34" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="350.5" y="1167.897">data is valid, has gps, air humidity and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="404.5" y="1185.603">temperature details</text></g><!--MD5=[29921640b317d18516d080204e8f3cac]
link data_type to Irrigation--><g id="link_data_type_Irrigation"><path d="M493.79,1080.04 C511.35,1090.09 556.34,1118.01 581.5,1153 C594.74,1171.41 604.02,1194.83 610.2,1214.84 " fill="none" id="data_type-to-Irrigation-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="611.71,1219.85,612.9765,1210.0829,610.2837,1215.0577,605.3089,1212.3649,611.71,1219.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="600.5" y="1167.897">data is valid, has gps, illuminance and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="652" y="1185.603">soil moisture details</text></g><!--MD5=[29921640b317d18516d080204e8f3cac]
link data_type to Irrigation--><g id="link_data_type_Irrigation"><path d="M493.55,1080.23 C509.59,1089.65 550.31,1112.35 587.5,1123 C640.02,1138.04 795.3,1112.08 831.5,1153 C874.7,1201.84 782.16,1230.38 706.26,1244.97 " fill="none" id="data_type-to-Irrigation-2" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="701.29,1245.91,710.8762,1248.1694,706.2031,1244.9817,709.3908,1240.3085,701.29,1245.91" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="842.5" y="1167.897">data is valid, has gps and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="875" y="1185.603">trigger details</text></g><!--MD5=[038594faa8418c70f66b722c317ad5a6]
link data_type to Alert--><g id="link_data_type_Alert"><path d="M498.53,1075 C518.59,1075 560.55,1075 599.43,1075 " fill="none" id="data_type-to-Alert" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="604.65,1075,595.65,1071,599.65,1075,595.65,1079,604.65,1075" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="516.75" y="1067.897">data is valid</text></g><!--MD5=[91907c84543eb3638356de3da4d3e836]
@startuml data-flow

skinparam Monochrome true

note "Data after going though Data Gateway is wrapped\n inside an Environment Message, this message is\n'open' in each container so that data can be accessed.\n Then, once the work is done the message is 'sealed',\n routing keys are changed and the message is sent.\nFor brevity this process is not detailed everywhere" as N1

state "Data Relayer" as DataRelayer
state "Data Gateway" as DataGateway
state decoded_or_encoded <<choice>>
state "Data Processor Slave" as Processor
state "Data Decoder Slave" as Decoder
state "Device Ownership" as Identity
state "Data Validator" as Validator
state "Device Management Slave" as Device
state data_type <<choice>>
state "Fleet Management" as Fleet
state "Smart Irrigation" as Irrigation
state "Alert Dispatcher" as Alert

DataRelayer : Any data can be received
DataRelayer : as the body of an HTTP POST

DataGateway : Data is wraped in a
DataGateway : Environment Message with
DataGateway : specific routing keys

Processor : Data is transformed according
Processor : to the defined mapper for the
Processor : type of device that sent the data

Decoder : Data is transformed according
Decoder : to the defined script for the
Decoder : type of device that sent the data

Identity : Domain ownership details are
Identity : added to the data

Validator : Data is examined to determine
Validator : if it is valid or not

Device : Device information details
Device : are added to the data

Fleet : Data is stored
Fleet : and sent to Frontend

Irrigation: Data is stored
Irrigation: and sent to Frontend

Alert: Data is analised and
Alert: alerts are produced
Alert: based on rules

[*] - -> DataRelayer
DataRelayer -> DataGateway
DataGateway -> decoded_or_encoded
decoded_or_encoded - -> Processor : decoded data
decoded_or_encoded - -> Decoder : encoded data
Decoder - -> Identity
Processor - -> Identity

Identity -> Device

Device - -> Validator

Device - - -> Identity : each sub device\ndata is sub processed

Validator - -> data_type

data_type - -> Fleet : data is valid, has\ngps details

data_type - -> Irrigation : data is valid, has gps, air humidity and\ntemperature details
data_type - -> Irrigation : data is valid, has gps, illuminance and\nsoil moisture details
data_type - -> Irrigation : data is valid, has gps and\ntrigger details

data_type -> Alert : data is valid

@enduml

PlantUML version 1.2022.4(Sat Apr 09 14:29:17 WEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>